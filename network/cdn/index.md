# CDN

CDN 全程内容分发网络(Network Delivery Network)

当你给一个域名开通了 CDN，要先给域名的 DNS 解析设置的后台添加一条**CDN 专用解析记录**，这条解析记录会让域名被解析之后，指向一个 CDN 网络专用的处理 DNS 请求的服务器。这个专门的 CDN 网络的 DNS 服务器（CDN 网络专用 DNS）会给你的浏览器返回一台专门用来给各个请求设备分配合适的 CDN 服务器的这样一种服务器（CDN 负载均衡）的 IP 地址，这种服务器叫做**负载均衡系统服务器**。然后你的设备或者说是你的浏览器就会去访问这台负载均衡系统服务器，负载均衡系统服务器会根据你浏览器的网络地址，会在 CDN 网络中找一台在各种条件下都比较适合给你的设备提供服务的这样一台服务器，比如说可能离你比较近，然后被分配的访问任务又不多的服务器。接着负载均衡系统服务器会把这台 CDN 服务器的 IP 地址返回给你的浏览器，那么浏览器在收到这个 IP 地址之后，就会去访问 CDN 网络中的这台 CDN 服务器了，去向他请求网站的文件资源。

但是这里有问题，网站的文件按理说都是放在自己的网站服务器上的，并没有放在 CDN 服务器上。其实在为某个网址开通 CDN（服务）的时候，那一开始会通过 CDN 后台进行设置，你需要告诉你的 CDN 网络，该域名的原始服务器的 IP 地址简称**源站的 IP**，而你的网站文件就是放在源站上，这台被请求网站文件的 CDN 服务器，在收到浏览器的获取请求之后，如果发现自己这里并没有相关（没有缓存）的网站文件，他就会去 CDN 网络中的上层缓存服务器中去拉取。如果上一层还没有会继续向上找，如果一直往上找都找不到相关文件，最后它就会去到网站的源站上面去拉取它的网站文件。拉取回来之后会在每一层刚才查找不得得 CDN 服务器上都做个缓存，最后这台指定为你提供服务的 CDN 服务器会发送网站文件给浏览器，这样浏览器就能打开该域名的网站了。
